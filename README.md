<img width="204" height="204" alt="image" src="https://github.com/user-attachments/assets/ba3beffc-7947-4651-979c-a2ca34d30f78" />


## IGNITE (Integrated Generative Network for Iterative Targeted Engineering)
LSTM + GCN/MLP Property Predictor + Reinforcement Learning

This repository implements a molecular generative model trained with reinforcement learning, where:

* The LSTM autoregressively generates SMILES strings

* A GCN + MLP model predicts a target molecular property (e.g., singlet–triplet gap)

* A REINFORCE RL loop updates the LSTM to generate molecules with desirable properties

The full workflow is:

```
SMILES → LSTM → generate candidates → GCN+MLP → property prediction → reward → update LSTM
```

This README explains how to install, train, generate, and extend the system.

## 0. Installation

```
conda create -n molrl python=3.10
conda activate molrl

# Install RDKit
conda install -c conda-forge rdkit

# Install PyTorch
pip install torch torchvision torchaudio

# Extra libraries
pip install tqdm pandas numpy scikit-learn
```
## 1. Input Format

### GCN Input File

For GCN, the input file should contain the first column `"SMILES"` and the second column `target_col` (`ST_split` in this case).  
This `.txt` file should be **tab-separated**.

```text
SMILES	ST_split
c1ccccc1	0.142
CCN(CC)CC	0.087
C1=CC=CN=C1	0.215
```

### MolGen Input File

For MolGen, the input file should only contain a column `"SMILES"` and is also a **tab-separated** `.txt`.

```text
SMILES
c1ccccc1
CCN(CC)CC	
C1=CC=CN=C1
```

### Dataset Flexability

Users may customize their own datasets. The MolGen generator and the GCN property predictor do not need to be trained on the same set of molecules.

You can mix and match:

* Train GCN on one dataset

* Train LSTM on a different dataset

* Use RL to align the LSTM output with GCN-predicted properties

They work independently and integrate only during the RL fine-tuning loop.

## 2. Molecule Generation

IGNITE includes a Long Short-Term Memory (LSTM)–based generative model capable of exploring large chemical spaces and proposing novel SMILES sequences. The model learns the underlying statistical patterns of molecular structures and can be trained on any user-provided SMILES dataset.

### Training the Model
```
python train_lstm.py \
    --train_path data/my_train.txt \
    --val_path data/my_val.txt \
    --tokenizer_vocab_path data/smiles_master.csv \
    --hidden_dim 512 \
    --num_layers 6 \
    --dropout 0.3 \
    --batch_size 256 \
    --learning_rate 2e-4 \
    --num_epochs 4000 \
    --patience 30 \
    --model_path outputs/lstm_large.pt

```

More complex architectures, such as transformer and GAN will be released soon.

## 3. Molecular Properties Prediction

To predict molecular properties (e.g., the singlet–triplet energy gap), IGNITE provides a GCN (Graph Convolutional Network) + MLP (Multi-Layer Perceptron) architecture.  
This model takes molecular graphs—constructed from adjacency matrices and atom-level features—and learns to map them to numerical property values.

### Training the Model
```
python3 /GCN/gcn_mlp/train_val.py \
    --input_dim 42 \
    --hidden_dim_gcn 200 \
    --hidden_dim_mlp 400 \
    --output_dim 1 \
    --batch_size 32 \
    --epochs 150 \
    --learning_rate 1e-4 \
    --loss_fn huber \
    --scheduler_patience 15 \
    --scheduler_factor 0.2 \
    --device cpu \
    --model_path outputs/gcn_model_custom.pth
```

### Evaluating the Model  
(Also used to score molecules generated by MolGen)
```
python3 /GCN/gcn_mlp/evaluate.py
```

## 4. Reinforcement Learning

In practical applications, it is often desirable to steer molecule generation toward specific target properties—for example, designing molecules with a low singlet–triplet gap.  
IGNITE enables this by fine-tuning the MolGen LSTM generator using the GCN-based property predictor as feedback. Through reinforcement learning, the generator is gradually optimized to produce molecules that better satisfy the desired property objectives.


To fine-tune the MolGen generator using the GCN+MLP property predictor (REINFORCE):

```
python rl_finetune.py \
    --target_gap 0.1 \
    --steps 1000 \
    --lstm_path MolGen_RL/lstm.pt \
    --gcn_mlp_path MolGen_RL/gcn_mlp.pth \
    --save_dir outputs/rl_checkpoints \
    --learning_rate 1e-4 \
    --device cuda
```
